
## 一、是基于MySQL二进制日志的高性能数据同步系统。Canal在阿里巴巴集团（包括https://www.taobao.com）中被广泛使用，以**提供可靠的低延迟增量数据管道**。

Canal Server能够解析MySQL Binlog并订阅数据更改，而Canal Client可以实现将更改广播到任何地方，例如: 数据库和Apache Kafka(阿里云消息队列)。

## 二、背景

早期，阿里巴巴B2B公司需要在美国和中国杭州之间同步服务器的数据。先前的数据库同步机制是基于trigger以获得增量更新的。从2010年开始，阿里巴巴集团开始使用数据集二进制日志获取增量更新并跨服务器同步数据，这催生了我们的增量订阅和使用服务（现已在阿里云中提供）并开始了一个新时代。

## 三、如何运作
### MySQL主从复制实现

复制遵循三步过程：
![](认识canal_files/1.jpg)
1. 主服务器将更改记录到binlog中（这些记录称为binlog事件，可以通过来查看show binary events）
2. 从服务器将主服务器的二进制日志事件复制到其中继日志。
3. 中继日志中的从服务器重做事件将随后更新其旧数据。

### Canal如何运作

原理很简单：
![](认识canal_files/2.jpg)
1. Canal模拟MySQL从站的交互协议，伪装成MySQL从站，然后将转储协议发送到MySQL主服务器。
2. MySQL Master收到了转储请求，并开始将二进制日志推送到slave（即运河）。
3. 运河将二进制日志对象解析为其自己的数据类型（最初为字节流）